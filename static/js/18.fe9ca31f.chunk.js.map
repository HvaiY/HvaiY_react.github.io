{"version":3,"sources":["views/Profile/index.jsx"],"names":["Profile","connect","state","avatar","user","changeAvatar","avatarUrl","isUploading","handleUploadAvatar","file","setState","data","FormData","append","axios","post","then","resp","status","props","linkurl","catch","error","console","log","title","bordered","showUploadList","customRequest","this","spinning","src","style","width","height","alt","border","display","Component"],"mappings":"8PAYMA,EADLC,aALgB,SAACC,GAChB,MAAO,CACLC,OAAQD,EAAME,KAAKD,UAGJ,CAAEE,kB,+MAEnBH,MAAQ,CACNI,UAAW,GACXC,aAAa,G,EAEfC,mBAAqB,YAAe,IAAZC,EAAW,EAAXA,KACtB,EAAKC,SAAS,CACZH,aAAa,IAGf,IAAMI,EAAO,IAAIC,SACjBD,EAAKE,OACH,QACA,0LAEFF,EAAKE,OAAO,OAAQJ,GACpBK,IACGC,KAAK,wBAAyBJ,GAC9BK,MAAK,SAACC,GACe,MAAhBA,EAAKC,SACP,EAAKR,SAAS,CACZH,aAAa,IAEf,EAAKY,MAAMd,aAAaY,EAAKN,KAAKS,aAGrCC,OAAM,SAACC,GACNC,QAAQC,IAAIF,O,uDAIhB,OACE,uBAAMG,MAAM,2BAAOC,UAAU,GAE3B,uBAEEC,gBAAgB,EAChBC,cAAeC,KAAKrB,oBAEpB,uBAAMsB,SAAUD,KAAK3B,MAAMK,aACxBsB,KAAKV,MAAMhB,OACV,yBACE4B,IAAKF,KAAKV,MAAMhB,OAChB6B,MAAO,CAAEC,MAAO,GAAIC,OAAQ,IAC5BC,IAAI,iBAGN,0BACEH,MAAO,CACLI,OAAQ,iBACRH,MAAO,GACPC,OAAQ,GACRG,QAAS,UALb,mC,GA/CQC,e,EAiEPtC","file":"static/js/18.fe9ca31f.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { Card, Upload, Spin } from \"antd\";\r\nimport axios from \"axios\";\r\nimport { connect } from \"react-redux\";\r\nimport { changeAvatar } from \"../../actions/useraction\";\r\n\r\nconst stateMap = (state) => {\r\n  return {\r\n    avatar: state.user.avatar,\r\n  };\r\n};\r\n@connect(stateMap, { changeAvatar })\r\nclass Profile extends Component {\r\n  state = {\r\n    avatarUrl: \"\",\r\n    isUploading: false,\r\n  };\r\n  handleUploadAvatar = ({ file }) => {\r\n    this.setState({\r\n      isUploading: true,\r\n    });\r\n    //贴图doc  http://www.tietuku.com/doc\r\n    const data = new FormData();\r\n    data.append(\r\n      \"Token\",\r\n      \"815835856668fc45650b5487d18dbdddc9624f9d:_5VZJ3ZPlbY1gVJXmHh_UMYFnhQ=:eyJkZWFkbGluZSI6MTU5MDE1Njk0MiwiYWN0aW9uIjoiZ2V0IiwidWlkIjoiNzE5NTU3IiwiYWlkIjoiMTY5MTE3MyIsImZyb20iOiJmaWxlIn0=\"\r\n    );\r\n    data.append(\"file\", file);\r\n    axios\r\n      .post(\"http://up.imgapi.com/\", data)\r\n      .then((resp) => {\r\n        if (resp.status === 200) {\r\n          this.setState({\r\n            isUploading: false,\r\n          });\r\n          this.props.changeAvatar(resp.data.linkurl);\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n  render() {\r\n    return (\r\n      <Card title=\"个人设置\" bordered={false}>\r\n        {/* avatar 上传可以使用antd 的案例，这里自定义使用 */}\r\n        <Upload\r\n          // 是否显示上传的列表 默认true\r\n          showUploadList={false}\r\n          customRequest={this.handleUploadAvatar}\r\n        >\r\n          <Spin spinning={this.state.isUploading}>\r\n            {this.props.avatar ? (\r\n              <img\r\n                src={this.props.avatar}\r\n                style={{ width: 80, height: 80 }}\r\n                alt=\"头像\"\r\n              />\r\n            ) : (\r\n              <span\r\n                style={{\r\n                  border: \"1px dashed red\",\r\n                  width: 80,\r\n                  height: 80,\r\n                  display: \"block\",\r\n                }}\r\n              >\r\n                上传头像\r\n              </span>\r\n            )}\r\n          </Spin>\r\n        </Upload>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Profile;\r\n"],"sourceRoot":""}